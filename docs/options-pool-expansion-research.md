# æœŸæƒæ± æ‰©å±•å¯è¡Œæ€§ç ”ç©¶æŠ¥å‘Š

> ç ”ç©¶æ—¥æœŸ: 2026-02-04
> çŠ¶æ€: ç ”ç©¶é˜¶æ®µ

## ç›®å½•

1. [å½“å‰ç³»ç»Ÿæž¶æž„æ¦‚è¿°](#å½“å‰ç³»ç»Ÿæž¶æž„æ¦‚è¿°)
2. [Aè‚¡åœºå†…æœŸæƒ (ETF/è‚¡æŒ‡)](#1-aè‚¡åœºå†…æœŸæƒ-etfè‚¡æŒ‡)
3. [æ¸¯è‚¡æœŸæƒ](#2-æ¸¯è‚¡æœŸæƒ)
4. [å•†å“æœŸæƒ](#3-å•†å“æœŸæƒ)
5. [å®žæ–½ä¼˜å…ˆçº§å»ºè®®](#å®žæ–½ä¼˜å…ˆçº§å»ºè®®)
6. [å…·ä½“å®žæ–½æ–¹æ¡ˆ](#å…·ä½“å®žæ–½æ–¹æ¡ˆ)

---

## å½“å‰ç³»ç»Ÿæž¶æž„æ¦‚è¿°

| ç»„ä»¶ | å½“å‰çŠ¶æ€ |
|------|---------|
| **æ•°æ®æº** | yfinance (ä¸»), Tiger API, DefeatBeta, Alpha Vantage, Tushare |
| **æ”¯æŒå¸‚åœº** | ç¾Žè‚¡ (ä¸»), æ¸¯è‚¡ (éƒ¨åˆ†), Aè‚¡ (ä»…è‚¡ç¥¨) |
| **æœŸæƒåˆ†æž** | 4ç§ç­–ç•¥è¯„åˆ† + VRPè®¡ç®— + é£Žé™©è°ƒæ•´ + Greeksåˆ†æž |

### æ ¸å¿ƒåˆ†æžæ¨¡å—

- **ç­–ç•¥è¯„åˆ†**: Sell Put, Sell Call, Buy Call, Buy Put
- **é«˜çº§åˆ†æž**: VRP (æ³¢åŠ¨çŽ‡é£Žé™©æº¢ä»·), é£Žé™©è°ƒæ•´å™¨
- **è¶‹åŠ¿åˆ†æž**: ATRè®¡ç®—, æ”¯æ’‘/é˜»åŠ›ä½
- **é£Žé™©ç”»åƒ**: æ”¶ç›Šé£Žé™©ç‰¹å¾åˆ†ç±»

### æ•°æ®é€‚é…å™¨æž¶æž„

```
MarketDataService (å•ä¾‹)
    â”œâ”€â”€ YFinanceAdapter (ä¼˜å…ˆçº§10, US/HK)
    â”œâ”€â”€ TigerAdapter (ä¼˜å…ˆçº§15, US/HK/CN)
    â”œâ”€â”€ DefeatBetaAdapter (ä¼˜å…ˆçº§20, æœ¬åœ°DuckDB)
    â”œâ”€â”€ TushareAdapter (ä¼˜å…ˆçº§10-CN, ä»…è‚¡ç¥¨)
    â””â”€â”€ AlphaVantageAdapter (ä¼˜å…ˆçº§30, å¤‡ç”¨)
```

---

## 1. Aè‚¡åœºå†…æœŸæƒ (ETF/è‚¡æŒ‡)

### äº§å“å®šä½

> **åŽ‹èˆ±çŸ³** â­â­â­â­â­
>
> æœ€ä¸ºç¨³å¥çš„æ”¶ç§Ÿæˆ˜åœºï¼ŒæµåŠ¨æ€§æžä½³ï¼Œé€‚åˆå¤§èµ„é‡‘ä½œä¸ºåº•ä»“ã€‚

### æŽ¨èæ ‡çš„

| æ ‡çš„ | ä»£ç  | ç”¨é€” |
|------|------|------|
| 50ETF | 510050 | æ ¸å¿ƒåº•ä»“ |
| 300ETF | 510300 | æ ¸å¿ƒåº•ä»“ |
| ä¸­è¯1000 | MO | é¿é™©ç”¨ |

### æ ¸å¿ƒç­–ç•¥

- å–å‡ºå®½è·¨å¼ (Short Strangle)
- å¤‡å…‘ç­–ç•¥ (Covered Call)

### ä¼˜åŠ¿ä¸Žé£Žé™©

| ä¼˜åŠ¿ (Pros) | é£Žé™© (Risk) |
|-------------|-------------|
| ä¸–ç•Œçº§æµåŠ¨æ€§ï¼Œå‡ ä¹Žæ— æ»‘ç‚¹ | Pin Risk (è¡ŒæƒæŒ‡æ´¾) æ˜¯æœ€å¤§éšæ‚£ |
| è§„åˆ™æžå…¶é€æ˜Ž | |
| è‚¡æŒ‡æœŸæƒçŽ°é‡‘äº¤å‰²æ— æŽ¥è´§é£Žé™© | |

---

### æ•°æ®å¯ç”¨æ€§è¯„ä¼°: âš ï¸ éœ€è¦æ–°æ•°æ®æº

| æ•°æ®æº | æ”¯æŒçŠ¶æ€ | è¯´æ˜Ž |
|--------|---------|------|
| **Tushare** | âŒ ä¸æ”¯æŒ | ä»£ç æ˜¾ç¤º: `Tushare doesn't provide options data for A-shares` |
| **yfinance** | âŒ ä¸æ”¯æŒ | ä¸è¦†ç›–ä¸­å›½äº¤æ˜“æ‰€æœŸæƒ |
| **Tiger API** | âš ï¸ éƒ¨åˆ† | æ”¯æŒCNå¸‚åœºï¼Œä½†æœŸæƒæ•°æ®éœ€éªŒè¯ |
| **å¤©å‹¤TqSdk** | âœ… å¯ç”¨ | å…è´¹æä¾›50ETF/300ETFæœŸæƒå®žæ—¶è¡Œæƒ… |
| **é‡‘æ•°æº** | âœ… å¯ç”¨ | æä¾›åŽ†å²tick/åˆ†é’Ÿ/æ—¥çº¿æ•°æ® |
| **ä¸Šäº¤æ‰€å®˜æ–¹** | âœ… å¯ç”¨ | æä¾›æŠ€æœ¯æŽ¥å£æ–‡æ¡£ |

#### æ•°æ®æºé“¾æŽ¥

- [å¤©å‹¤TqSdkæ–‡æ¡£](https://doc.shinnytech.com/tqsdk/latest/usage/mddatas.html)
- [é‡‘æ•°æºæ•°æ®æœåŠ¡](http://www.jinshuyuan.net/)
- [ä¸Šäº¤æ‰€æŠ€æœ¯æŽ¥å£](https://www.sse.com.cn/services/tradingtech/data/)

#### TqSdk æ”¯æŒçš„æœŸæƒåˆçº¦ç¼–ç 

```python
SSE.10002513   # ä¸Šè¯50ETFæœŸæƒ
SSE.10002504   # æ²ªæ·±300ETFæœŸæƒ (ä¸Šäº¤æ‰€)
SZSE.90000097  # æ²ªæ·±300ETFæœŸæƒ (æ·±äº¤æ‰€)
SZSE.90001277  # åˆ›ä¸šæ¿ETFæœŸæƒ
CFFEX.MO       # ä¸­è¯1000è‚¡æŒ‡æœŸæƒ
```

**æŽ¨èæ–¹æ¡ˆ**: é›†æˆ **TqSdk** ä½œä¸ºAè‚¡æœŸæƒæ•°æ®æº

---

### ç®—æ³•å…¼å®¹æ€§è¯„ä¼°: âœ… é«˜åº¦å…¼å®¹

| ç®—æ³•æ¨¡å— | å…¼å®¹æ€§ | éœ€è¦è°ƒæ•´ |
|----------|--------|---------|
| ç­–ç•¥è¯„åˆ† | âœ… å…¼å®¹ | æ—  - é€šç”¨Black-Scholesæ¨¡åž‹ |
| Greeksè®¡ç®— | âœ… å…¼å®¹ | æ—  - äº¤æ˜“æ‰€ç›´æŽ¥æä¾› |
| VRPåˆ†æž | âœ… å…¼å®¹ | éœ€è¦åŽ†å²IVæ•°æ® |
| è¶‹åŠ¿åˆ†æž | âš ï¸ éœ€è°ƒæ•´ | éœ€è°ƒæ•´é˜ˆå€¼ (Aè‚¡æ³¢åŠ¨çŽ‡ä¸åŒ) |

#### å…³é”®å·®å¼‚ç‚¹

- è‚¡æŒ‡æœŸæƒä¸º**çŽ°é‡‘äº¤å‰²**ï¼Œæ— æŽ¥è´§é£Žé™©
- T+0äº¤æ˜“è§„åˆ™
- æ¶¨è·Œåœé™åˆ¶ä¸åŒäºŽç¾Žè‚¡
- æ— é£Žé™©åˆ©çŽ‡ä½¿ç”¨ä¸­å›½å›½å€ºæ”¶ç›ŠçŽ‡

---

### å®¹é‡è¯„ä¼°: â­â­â­â­â­ æžä½³

| æ ‡çš„ | æ—¥å‡æˆäº¤é‡ | æµåŠ¨æ€§è¯„çº§ |
|------|-----------|-----------|
| 50ETFæœŸæƒ | ~200ä¸‡å¼  | ä¸–ç•Œå‰ä¸‰ |
| 300ETFæœŸæƒ | ~150ä¸‡å¼  | ä¸–ç•Œçº§ |
| ä¸­è¯1000æœŸæƒ | ~50ä¸‡å¼  | ä¼˜ç§€ |

**ç»“è®º**: æµåŠ¨æ€§æžä½³ï¼Œé€‚åˆå¤§èµ„é‡‘æ“ä½œï¼Œæ»‘ç‚¹å‡ ä¹Žå¯å¿½ç•¥

---

## 2. æ¸¯è‚¡æœŸæƒ

### äº§å“å®šä½

> **é«˜æ”¶ç›Šå«æ˜Ÿ** â­â­â­â­â˜†
>
> é«˜æ³¢åŠ¨çŽ‡å¸¦æ¥çš„é«˜æƒåˆ©é‡‘ï¼Œä½†å¿…é¡»ä¸¥æ ¼ç­›é€‰å¤´éƒ¨èµ„äº§ã€‚

### æŽ¨èæ ‡çš„

| æ ‡çš„ | ä»£ç  | ç‰¹ç‚¹ |
|------|------|------|
| è…¾è®¯ | 0700.HK | å‘¨æƒå¯ç”¨ |
| é˜¿é‡Œ | 9988.HK | å‘¨æƒå¯ç”¨ |
| ç¾Žå›¢ | 3690.HK | å‘¨æƒå¯ç”¨ |

### æ ¸å¿ƒç­–ç•¥

- ç™½åå•åˆ¶åº¦
- å–å‡ºè™šå€¼çœ‹è·Œ (OTM Sell Put)

### ä¼˜åŠ¿ä¸Žé£Žé™©

| ä¼˜åŠ¿ (Pros) | é£Žé™© (Risk) |
|-------------|-------------|
| æ³¢åŠ¨çŽ‡æº¢ä»·é«˜ (Rich Premium) | é•¿å°¾èµ„äº§æµåŠ¨æ€§æž¯ç«­ (Bid-Ask spread å·¨å¤§) |
| T+0 äº¤æ˜“çµæ´» | ä¸ªè‚¡é»‘å¤©é¹…é£Žé™© |
| å‘¨æƒ Theta è¡°å‡æžå¿« | |

---

### æ•°æ®å¯ç”¨æ€§è¯„ä¼°: âœ… çŽ°æœ‰åŸºç¡€è®¾æ–½å¯æ”¯æŒ

| æ•°æ®æº | æ”¯æŒçŠ¶æ€ | è¯´æ˜Ž |
|--------|---------|------|
| **yfinance** | âš ï¸ éƒ¨åˆ† | æ”¯æŒ.HKè‚¡ç¥¨ï¼ŒæœŸæƒé“¾APIå¯èƒ½å—é™ |
| **Tiger API** | âœ… æ”¯æŒ | å·²é…ç½® `supported_markets=[Market.US, Market.HK, Market.CN]` |
| **HKEXå®˜æ–¹** | âœ… æ”¯æŒ | æä¾›æœŸæƒè¯¦æƒ…ã€CSVå¯¼å‡º |
| **hkex.api (R)** | âœ… æ”¯æŒ | ç›´æŽ¥ä»ŽHKEXèŽ·å–æ•°æ® |

#### æ•°æ®æºé“¾æŽ¥

- [Yahoo Finance è…¾è®¯æœŸæƒé“¾](https://finance.yahoo.com/quote/0700.HK/options/)
- [HKEX è‚¡ç¥¨æœŸæƒè¯¦æƒ…](https://www.hkex.com.hk/eng/sorc/options/stock_options_detail.aspx?oID=1309843&ucode=00700)
- [hkex.api RåŒ…](https://rdrr.io/cran/hkex.api/)

#### çŽ°æœ‰é›†æˆçŠ¶æ€

```python
# backend/app/services/market_data/adapters/tiger_adapter.py
def supported_markets(self) -> List[Market]:
    return [Market.US, Market.HK, Market.CN]  # âœ… å·²æ”¯æŒHK
```

**æŽ¨èæ–¹æ¡ˆ**: ä¼˜å…ˆä½¿ç”¨ **Tiger API**ï¼Œyfinanceä½œä¸ºå¤‡é€‰

---

### ç®—æ³•å…¼å®¹æ€§è¯„ä¼°: âœ… å®Œå…¨å…¼å®¹

| ç®—æ³•æ¨¡å— | å…¼å®¹æ€§ | éœ€è¦è°ƒæ•´ |
|----------|--------|---------|
| ç­–ç•¥è¯„åˆ† | âœ… å…¼å®¹ | å·²æœ‰HKå¸‚åœºå‚æ•° |
| Greeksè®¡ç®— | âœ… å…¼å®¹ | é€šç”¨æ¨¡åž‹ |
| VRPåˆ†æž | âœ… å…¼å®¹ | æ— è°ƒæ•´ |
| é£Žé™©è°ƒæ•´ | âš ï¸ å·²é…ç½® | HKæ³¢åŠ¨çŽ‡ç³»æ•°=1.1x |

#### çŽ°æœ‰å¸‚åœºå‚æ•°

```python
# backend/app/params/market.py
'HK': {
    'min_daily_volume': 2000000,
    'risk_premium': 1.15,
    'pe_threshold_high': 35,
    'pe_threshold_very_high': 50,
    'volatility_adjustment': 1.1
}
```

---

### å®¹é‡è¯„ä¼°: â­â­â­â­ è‰¯å¥½ (å¤´éƒ¨èµ„äº§)

| æ ‡çš„ | æœŸæƒç±»åž‹ | æµåŠ¨æ€§è¯„çº§ |
|------|---------|-----------|
| è…¾è®¯ (0700) | æœˆæƒ+å‘¨æƒ | â­â­â­â­â­ ä¼˜ç§€ |
| é˜¿é‡Œ (9988) | æœˆæƒ+å‘¨æƒ | â­â­â­â­ è‰¯å¥½ |
| ç¾Žå›¢ (3690) | æœˆæƒ | â­â­â­ ä¸­ç­‰ |
| é•¿å°¾è‚¡ç¥¨ | - | âš ï¸ Bid-Ask spreadå·¨å¤§ |

**é£Žé™©æç¤º**: å¿…é¡»å®žæ–½**ç™½åå•åˆ¶åº¦**ï¼Œä»…å…è®¸é«˜æµåŠ¨æ€§æ ‡çš„å…¥æ± 

---

## 3. å•†å“æœŸæƒ

### äº§å“å®šä½

> **é«˜é£Žé™©ç‰¹ç§å…µ** â­â­â˜†â˜†â˜†
>
> ä»…é™ç‰¹å®šå“ç§çš„é˜²å¾¡æ€§å‡†å…¥ï¼Œå¿…é¡»æžå…¶å°å¿ƒäº¤å‰²æœˆè§„åˆ™ã€‚

### æŽ¨èæ ‡çš„

| å“ç§ | ä»£ç  | äº¤æ˜“æ‰€ | é£Žé™©ç­‰çº§ |
|------|------|--------|---------|
| è±†ç²• | M | DCE | ä¸­ |
| ç™½ç³– | SR | CZCE | ä¸­ |
| é“çŸ¿çŸ³ | I | DCE | é«˜ (æ…Žå…¥) |

### æ ¸å¿ƒç­–ç•¥

- ä»…åšä¸»åŠ›åˆçº¦ (Dominant Month)
- æ—¥åŽ†ä»·å·®
- å®½è·¨å¼

### ä¼˜åŠ¿ä¸Žé£Žé™©

| ä¼˜åŠ¿ (Pros) | é£Žé™© (Risk) |
|-------------|-------------|
| ä¾›éœ€é”™é…å¸¦æ¥çˆ†å‘æ€§æ³¢åŠ¨ | **ä¸´è¿‘äº¤å‰²æœˆå¼ºå¹³** (æœ€å¤§æ­»ç©´) |
| ä¸Žè‚¡å¸‚ç›¸å…³æ€§ä½Ž | éžä¸»åŠ›åˆçº¦æ— æµåŠ¨æ€§ |

---

### æ•°æ®å¯ç”¨æ€§è¯„ä¼°: âš ï¸ éœ€è¦å…¨æ–°åŸºç¡€è®¾æ–½

| æ•°æ®æº | æ”¯æŒçŠ¶æ€ | è¯´æ˜Ž |
|--------|---------|------|
| **yfinance** | âŒ ä¸æ”¯æŒ | ä¸è¦†ç›–ä¸­å›½å•†å“æœŸè´§ |
| **Tushare** | âŒ ä¸æ”¯æŒ | æ— æœŸæƒæ•°æ® |
| **Tiger API** | âŒ ä¸æ”¯æŒ | æ— å•†å“æœŸæƒ |
| **CTPæŽ¥å£** | âœ… å¯ç”¨ | éœ€è¦æœŸè´§å…¬å¸è´¦æˆ· |
| **å¤©å‹¤TqSdk** | âœ… å¯ç”¨ | å…è´¹æä¾›å•†å“æœŸæƒè¡Œæƒ… |
| **çœŸæ ¼é‡åŒ–** | âœ… å¯ç”¨ | æœŸè´§æœŸæƒå®žç›˜å¹³å° |

#### æ•°æ®æºé“¾æŽ¥

- [å¤©å‹¤TqSdkæ–‡æ¡£](https://doc.shinnytech.com/tqsdk/latest/usage/mddatas.html)
- [çœŸæ ¼é‡åŒ–å¹³å°](https://quant.pobo.net.cn/doc?name=api)

#### CTPæŽ¥å£é™åˆ¶

- tickçº§åˆ«: 1ç§’2ä¸ªtick
- åŽ†å²è¡Œæƒ…éœ€å¦è´­
- æŸ¥è¯¢è¯·æ±‚: 1ç§’æœ€å¤š1ä¸ª
- éœ€è¦æœŸè´§å…¬å¸è´¦æˆ·å¼€é€š

---

### ç®—æ³•å…¼å®¹æ€§è¯„ä¼°: âš ï¸ éœ€è¦é‡å¤§ä¿®æ”¹

| ç®—æ³•æ¨¡å— | å…¼å®¹æ€§ | éœ€è¦è°ƒæ•´ |
|----------|--------|---------|
| ç­–ç•¥è¯„åˆ† | âš ï¸ éƒ¨åˆ†å…¼å®¹ | éœ€è¦å•†å“ç‰¹å®šå› å­ (å­£èŠ‚æ€§ã€åŸºå·®) |
| Greeksè®¡ç®— | âœ… å…¼å®¹ | é€šç”¨æ¨¡åž‹å¯ç”¨ |
| VRPåˆ†æž | âš ï¸ éƒ¨åˆ†å…¼å®¹ | éœ€è¦ä¸åŒçš„æ³¢åŠ¨çŽ‡åŸºå‡† |
| è¶‹åŠ¿åˆ†æž | âŒ ä¸å…¼å®¹ | éœ€è¦å…¨æ–°çš„å•†å“è¶‹åŠ¿æ¨¡åž‹ |
| **äº¤å‰²é£Žé™©** | âŒ å…¨æ–° | **éœ€è¦æ–°æ¨¡å—** - ç›‘æŽ§äº¤å‰²æœˆå¼ºå¹³ |

#### å…³é”®å·®å¼‚ç‚¹

- **ä¸´è¿‘äº¤å‰²æœˆå¼ºå¹³é£Žé™©** (æœ€å¤§æ­»ç©´ï¼Œå¿…é¡»ç›‘æŽ§)
- éžä¸»åŠ›åˆçº¦æ— æµåŠ¨æ€§
- ä¾›éœ€åŸºæœ¬é¢åˆ†æžéœ€æ±‚
- å­£èŠ‚æ€§å› ç´  (å†œäº§å“)
- åŸºå·®é£Žé™©
- å®žç‰©äº¤å‰² vs çŽ°é‡‘äº¤å‰²

---

### å®¹é‡è¯„ä¼°: â­â­ æœ‰é™ (ä»…ä¸»åŠ›åˆçº¦)

| å“ç§ | äº¤æ˜“æ‰€ | ä¸»åŠ›åˆçº¦æµåŠ¨æ€§ | éžä¸»åŠ›æµåŠ¨æ€§ |
|------|--------|---------------|-------------|
| è±†ç²• (M) | DCE | â­â­â­â­ è‰¯å¥½ | âš ï¸ æžå·® |
| ç™½ç³– (SR) | CZCE | â­â­â­â­ è‰¯å¥½ | âš ï¸ æžå·® |
| é“çŸ¿çŸ³ (I) | DCE | â­â­â­ ä¸­ç­‰ | âš ï¸ æ…Žå…¥ |

**é£Žé™©æç¤º**: å¿…é¡»å®žæ–½**ä¸»åŠ›åˆçº¦é™åˆ¶**ï¼Œå¹¶ç›‘æŽ§è·äº¤å‰²æœˆå¤©æ•°

---

## å®žæ–½ä¼˜å…ˆçº§å»ºè®®

| ä¼˜å…ˆçº§ | å¸‚åœº | ç†ç”± | å¼€å‘å·¥ä½œé‡ | é¢„è®¡å‘¨æœŸ |
|--------|------|------|-----------|---------|
| **1** | ðŸ‡­ðŸ‡° æ¸¯è‚¡æœŸæƒ | çŽ°æœ‰åŸºç¡€è®¾æ–½å¯æ”¯æŒï¼Œç®—æ³•å®Œå…¨å…¼å®¹ | **ä½Ž** | 2-3å¤© |
| **2** | ðŸ‡¨ðŸ‡³ Aè‚¡ETFæœŸæƒ | æµåŠ¨æ€§æžä½³ï¼Œéœ€é›†æˆTqSdk | **ä¸­** | 1-2å‘¨ |
| **3** | ðŸŒ¾ å•†å“æœŸæƒ | éœ€è¦å…¨æ–°åŸºç¡€è®¾æ–½å’Œç®—æ³• | **é«˜** | 3-4å‘¨ |

---

## å…·ä½“å®žæ–½æ–¹æ¡ˆ

### Phase 1: æ¸¯è‚¡æœŸæƒ (å¿«é€Ÿå¯åŠ¨)

**ç›®æ ‡**: 2-3å¤©å†…ä¸Šçº¿

#### æ­¥éª¤

1. éªŒè¯Tiger APIçš„HKæœŸæƒæ•°æ®å®Œæ•´æ€§
2. æ·»åŠ æ¸¯è‚¡æœŸæƒç™½åå•
3. è°ƒæ•´å‰ç«¯æ”¯æŒ.HKåŽç¼€

#### ä»£ç å˜æ›´

```python
# backend/app/constants.py æˆ–æ–°å»º backend/app/params/options_whitelist.py

HK_OPTIONS_WHITELIST = [
    '0700.HK',  # è…¾è®¯
    '9988.HK',  # é˜¿é‡Œå·´å·´
    '3690.HK',  # ç¾Žå›¢
    '1299.HK',  # å‹é‚¦ä¿é™©
    '0005.HK',  # æ±‡ä¸°æŽ§è‚¡
    '0388.HK',  # æ¸¯äº¤æ‰€
    '2318.HK',  # ä¸­å›½å¹³å®‰
]
```

---

### Phase 2: Aè‚¡ETFæœŸæƒ (æ–°é€‚é…å™¨)

**ç›®æ ‡**: 1-2å‘¨å†…ä¸Šçº¿

#### æ­¥éª¤

1. é›†æˆTqSdkåº“
2. åˆ›å»ºTqSdkAdapteré€‚é…å™¨
3. æ·»åŠ Aè‚¡æœŸæƒå¸‚åœºå‚æ•°
4. è°ƒæ•´å‰ç«¯æ”¯æŒæ–°æ ‡çš„

#### ä»£ç å˜æ›´

```python
# æ–°å»º: backend/app/services/market_data/adapters/tqsdk_adapter.py

from tqsdk import TqApi, TqAuth

class TqSdkAdapter(BaseAdapter, DataProviderAdapter):
    """å¤©å‹¤é‡åŒ–æ•°æ®é€‚é…å™¨ - Aè‚¡æœŸæƒä¸“ç”¨"""

    SUPPORTED_OPTIONS = {
        '510050': 'SSE.10002513',   # 50ETFæœŸæƒ
        '510300': 'SSE.10002504',   # 300ETFæœŸæƒ (ä¸Šäº¤æ‰€)
        '159919': 'SZSE.90000097',  # 300ETFæœŸæƒ (æ·±äº¤æ‰€)
    }

    def get_options_chain(self, symbol: str) -> Optional[Dict]:
        """èŽ·å–Aè‚¡ETFæœŸæƒé“¾"""
        ...

    def get_option_expirations(self, symbol: str) -> Optional[List[str]]:
        """èŽ·å–å¯ç”¨åˆ°æœŸæ—¥"""
        ...
```

#### ä¾èµ–æ·»åŠ 

```txt
# backend/requirements.txt
tqsdk>=3.0.0
```

---

### Phase 3: å•†å“æœŸæƒ (æ·±åº¦å¼€å‘)

**ç›®æ ‡**: 3-4å‘¨å†…ä¸Šçº¿

#### æ­¥éª¤

1. æ‰©å±•TqSdké€‚é…å™¨æ”¯æŒå•†å“æœŸæƒ
2. åˆ›å»ºäº¤å‰²æœˆé£Žé™©ç›‘æŽ§æ¨¡å—
3. å¼€å‘å•†å“ç‰¹å®šè¯„åˆ†ç®—æ³•
4. å®žçŽ°ä¸»åŠ›åˆçº¦è‡ªåŠ¨è¯†åˆ«
5. æ·»åŠ å­£èŠ‚æ€§åˆ†æžå› å­

#### æ–°å¢žæ¨¡å—

```
backend/app/analysis/commodity_options/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ delivery_monitor.py      # äº¤å‰²æœˆé£Žé™©ç›‘æŽ§
â”œâ”€â”€ dominant_contract.py     # ä¸»åŠ›åˆçº¦è¯†åˆ«
â”œâ”€â”€ seasonality.py           # å­£èŠ‚æ€§åˆ†æž
â””â”€â”€ scoring/
    â”œâ”€â”€ commodity_sell_put.py
    â””â”€â”€ commodity_sell_call.py
```

#### äº¤å‰²æœˆé£Žé™©ç›‘æŽ§ç¤ºä¾‹

```python
# backend/app/analysis/commodity_options/delivery_monitor.py

class DeliveryMonitor:
    """å•†å“æœŸæƒäº¤å‰²æœˆé£Žé™©ç›‘æŽ§"""

    # å„äº¤æ˜“æ‰€å¼ºå¹³è§„åˆ™ (è·äº¤å‰²æœˆå¤©æ•°)
    FORCE_CLOSE_RULES = {
        'DCE': 10,   # å¤§å•†æ‰€: äº¤å‰²æœˆå‰10ä¸ªäº¤æ˜“æ—¥
        'CZCE': 10,  # éƒ‘å•†æ‰€: äº¤å‰²æœˆå‰10ä¸ªäº¤æ˜“æ—¥
        'SHFE': 15,  # ä¸ŠæœŸæ‰€: äº¤å‰²æœˆå‰15ä¸ªäº¤æ˜“æ—¥
    }

    def check_delivery_risk(self, symbol: str, expiry_date: date) -> Dict:
        """æ£€æŸ¥äº¤å‰²é£Žé™©"""
        days_to_expiry = (expiry_date - date.today()).days
        exchange = self._get_exchange(symbol)
        force_close_days = self.FORCE_CLOSE_RULES.get(exchange, 10)

        return {
            'days_to_expiry': days_to_expiry,
            'force_close_days': force_close_days,
            'risk_level': 'HIGH' if days_to_expiry <= force_close_days else 'NORMAL',
            'warning': days_to_expiry <= force_close_days + 5
        }
```

---

## é™„å½•

### A. æ•°æ®å­—æ®µå¯¹ç…§è¡¨

| å­—æ®µ | ç¾Žè‚¡ | æ¸¯è‚¡ | Aè‚¡ETF | å•†å“ |
|------|------|------|--------|------|
| strike | âœ… | âœ… | âœ… | âœ… |
| bid/ask | âœ… | âœ… | âœ… | âœ… |
| volume | âœ… | âœ… | âœ… | âœ… |
| open_interest | âœ… | âœ… | âœ… | âœ… |
| implied_volatility | âœ… | âœ… | âœ… | âœ… |
| delta/gamma/theta/vega | âœ… | âœ… | âœ… | âœ… |
| äº¤å‰²æ–¹å¼ | å®žç‰© | å®žç‰© | çŽ°é‡‘ | å®žç‰© |

### B. äº¤æ˜“æ—¶é—´å¯¹ç…§

| å¸‚åœº | äº¤æ˜“æ—¶é—´ (å½“åœ°) | æ—¶åŒº |
|------|----------------|------|
| ç¾Žè‚¡æœŸæƒ | 09:30-16:00 | EST |
| æ¸¯è‚¡æœŸæƒ | 09:30-16:00 | HKT |
| Aè‚¡ETFæœŸæƒ | 09:30-15:00 | CST |
| å•†å“æœŸæƒ | 09:00-15:00 / 21:00-23:00 | CST |

### C. å‚è€ƒèµ„æ–™

- [å¤©å‹¤é‡åŒ–SDKæ–‡æ¡£](https://doc.shinnytech.com/tqsdk/latest/)
- [ä¸Šäº¤æ‰€æœŸæƒæŠ€æœ¯æŽ¥å£](https://www.sse.com.cn/services/tradingtech/data/)
- [HKEXæœŸæƒæ•°æ®](https://www.hkex.com.hk/eng/sorc/)
- [é‡‘æ•°æºåŽ†å²æ•°æ®](http://www.jinshuyuan.net/)
