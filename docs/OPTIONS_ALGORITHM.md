# æœŸæƒæ¨èç®—æ³•è¯¦è§£

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜ AlphaGBM æœŸæƒæ¨èç³»ç»Ÿçš„æ ¸å¿ƒç®—æ³•ã€‚

> **2026å¹´1æœˆæ›´æ–°**ï¼šåŸºäºçœŸå®äº¤æ˜“è€…åé¦ˆï¼Œæ–°å¢è¶‹åŠ¿è¿‡æ»¤ã€ATRåŠ¨æ€å®‰å…¨è¾¹é™…ã€å¤šå‘¨æœŸæ”¯æ’‘é˜»åŠ›åˆ†æç­‰é‡è¦ä¼˜åŒ–ã€‚

---

## ç›®å½•

1. [ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ](#ä¸€ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ)
2. [å››ç§ç­–ç•¥ä»‹ç»](#äºŒå››ç§ç­–ç•¥ä»‹ç»)
3. [**è¶‹åŠ¿è¿‡æ»¤ç³»ç»Ÿï¼ˆæ–°ï¼‰**](#ä¸‰è¶‹åŠ¿è¿‡æ»¤ç³»ç»Ÿæ–°)
4. [**ATRåŠ¨æ€å®‰å…¨è¾¹é™…ï¼ˆæ–°ï¼‰**](#å››atråŠ¨æ€å®‰å…¨è¾¹é™…æ–°)
5. [**å¤šå‘¨æœŸæ”¯æ’‘é˜»åŠ›åˆ†æï¼ˆæ–°ï¼‰**](#äº”å¤šå‘¨æœŸæ”¯æ’‘é˜»åŠ›åˆ†ææ–°)
6. [Sell Put è®¡åˆ†å™¨](#å…­sell-put-è®¡åˆ†å™¨)
7. [Sell Call è®¡åˆ†å™¨](#ä¸ƒsell-call-è®¡åˆ†å™¨)
8. [Buy Call è®¡åˆ†å™¨](#å…«buy-call-è®¡åˆ†å™¨)
9. [Buy Put è®¡åˆ†å™¨](#ä¹buy-put-è®¡åˆ†å™¨)
10. [é£é™©æ”¶ç›Šé£æ ¼æ ‡ç­¾ç³»ç»Ÿ](#åé£é™©æ”¶ç›Šé£æ ¼æ ‡ç­¾ç³»ç»Ÿ)
11. [RV è¯„åˆ†ç³»ç»Ÿ](#åä¸€rv-è¯„åˆ†ç³»ç»Ÿ)
12. [æµåŠ¨æ€§è¯„åˆ†ç³»ç»Ÿ](#åäºŒæµåŠ¨æ€§è¯„åˆ†ç³»ç»Ÿ)
13. [VRP è®¡ç®—ç³»ç»Ÿ](#åä¸‰vrp-è®¡ç®—ç³»ç»Ÿ)
14. [æ¨èæ’åºé€»è¾‘](#åå››æ¨èæ’åºé€»è¾‘)

---

## ä¸€ã€ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æœŸæƒæ¨èç³»ç»Ÿæ¶æ„                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚ æœŸæƒé“¾   â”‚ -> â”‚ ç­–ç•¥è®¡åˆ†å™¨    â”‚ -> â”‚ é£æ ¼æ ‡ç­¾ç”Ÿæˆå™¨   â”‚     â”‚
â”‚   â”‚ æ•°æ®è·å– â”‚    â”‚ (4ç§ç­–ç•¥)    â”‚    â”‚ (é£é™©/æ”¶ç›Šåˆ†ç±»)  â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚               â”‚                      â”‚                â”‚
â”‚         v               v                      v                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚ VRPè®¡ç®—  â”‚    â”‚ æµåŠ¨æ€§ç­›é€‰   â”‚    â”‚ æ’åº & Top N    â”‚     â”‚
â”‚   â”‚ (IV-RV)  â”‚    â”‚ (OI/Spread)  â”‚    â”‚ è¾“å‡ºæ¨è        â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒæ–‡ä»¶**ï¼š
- `backend/app/services/options/sell_put.py` - Sell Put è®¡åˆ†å™¨
- `backend/app/services/options/sell_call.py` - Sell Call è®¡åˆ†å™¨
- `backend/app/services/options/buy_call.py` - Buy Call è®¡åˆ†å™¨
- `backend/app/services/options/buy_put.py` - Buy Put è®¡åˆ†å™¨
- `backend/app/services/options/risk_return_profile.py` - é£é™©æ”¶ç›Šé£æ ¼
- `backend/app/services/options/option_scorer.py` - RV è¯„åˆ†ç³»ç»Ÿ
- `backend/app/services/options/vrp_calculator.py` - VRP è®¡ç®—

---

## äºŒã€å››ç§ç­–ç•¥ä»‹ç»

| ç­–ç•¥ | ä¸­æ–‡å | é€‚ç”¨åœºæ™¯ | æœ€å¤§æ”¶ç›Š | æœ€å¤§äºæŸ | **ç†æƒ³è¶‹åŠ¿** |
|------|--------|----------|----------|----------|--------------|
| **Sell Put** | å–å‡ºçœ‹è·Œ | ä¸‹è·Œæ¥è´§/ä¸­æ€§ | æƒåˆ©é‡‘ | è¡Œæƒä»·-æƒåˆ©é‡‘ | ğŸ“‰ ä¸‹è·Œ |
| **Sell Call** | å–å‡ºçœ‹æ¶¨ | ä¸Šæ¶¨é”å®šæ”¶ç›Š | æƒåˆ©é‡‘ | ç†è®ºæ— é™ | ğŸ“ˆ ä¸Šæ¶¨ |
| **Buy Call** | ä¹°å…¥çœ‹æ¶¨ | å¼ºçƒˆçœ‹æ¶¨ | ç†è®ºæ— é™ | æƒåˆ©é‡‘ | ğŸ“ˆ ä¸Šæ¶¨ |
| **Buy Put** | ä¹°å…¥çœ‹è·Œ | çœ‹è·Œ/å¯¹å†² | è¡Œæƒä»·-æƒåˆ©é‡‘ | æƒåˆ©é‡‘ | ğŸ“‰ ä¸‹è·Œ |

> **äº¤æ˜“è€…ç»éªŒ**ï¼šSell Put åªåœ¨ä¸‹è·Œæ—¶åšï¼ˆä»·æ ¼æ›´ä¾¿å®œï¼Œæ¥è´§æ›´åˆ’ç®—ï¼‰ï¼ŒSell Call åªåœ¨ä¸Šæ¶¨æ—¶åšï¼ˆé”å®šæ”¶ç›Šï¼‰ã€‚

---

## ä¸‰ã€è¶‹åŠ¿è¿‡æ»¤ç³»ç»Ÿï¼ˆæ–°ï¼‰

### 3.1 æ ¸å¿ƒç†å¿µ

åŸºäºçœŸå®äº¤æ˜“è€…ç»éªŒï¼š
- **Sell Call** åªåœ¨ä¸Šæ¶¨æ—¶åšï¼šè‚¡ä»·ä¸Šæ¶¨æ—¶å–å‡ºçœ‹æ¶¨æœŸæƒé”å®šæ”¶ç›Š
- **Sell Put** åªåœ¨ä¸‹è·Œæ—¶åšï¼šè‚¡ä»·ä¸‹è·Œæ—¶å–å‡ºçœ‹è·ŒæœŸæƒæ¥è´§æ›´ä¾¿å®œ

### 3.2 è¶‹åŠ¿åˆ¤æ–­æ–¹æ³•

```python
def determine_intraday_trend(price_history, current_price):
    """åŸºäºå½“å¤©çš„è¶‹åŠ¿åˆ¤æ–­"""

    # 1. å½“æ—¥æ¶¨è·Œå¹…
    today_change = (current_price - prev_close) / prev_close
    # æ¶¨>0.5% = bullish, è·Œ>0.5% = bearish

    # 2. ç›¸å¯¹MA5ä½ç½®
    ma5_position = (current_price - ma5) / ma5
    # é«˜äº1% = bullish, ä½äº1% = bearish

    # 3. è¿‘5æ—¥åŠ¨é‡
    momentum_5d = (current_price - price_5d_ago) / price_5d_ago
    # æ¶¨>2% = bullish, è·Œ>2% = bearish

    # ç»¼åˆåˆ¤æ–­ï¼š3é¡¹ä¸­2é¡¹åŒå‘å³ä¸ºè¯¥è¶‹åŠ¿
```

### 3.3 è¶‹åŠ¿è¯„åˆ†çŸ©é˜µï¼ˆæ˜¾ç¤ºä½†é™åˆ†ï¼‰

| ç­–ç•¥ | ä¸Šæ¶¨è¶‹åŠ¿ | æ¨ªç›˜æ•´ç† | ä¸‹è·Œè¶‹åŠ¿ |
|------|----------|----------|----------|
| **Sell Call** | 100 âœ… | 60 | 30 âš ï¸ |
| **Sell Put** | 30 âš ï¸ | 60 | 100 âœ… |
| **Buy Call** | 100 | 50 | 20 |
| **Buy Put** | 20 | 50 | 100 |

> **è®¾è®¡åŸåˆ™**ï¼šä¸å®Œå…¨è¿‡æ»¤ä¸åŒ¹é…è¶‹åŠ¿çš„æ¨èï¼Œè€Œæ˜¯å¤§å¹…é™åˆ†ï¼Œè®©ç”¨æˆ·ä»å¯çœ‹åˆ°ä½†çŸ¥é“é£é™©ã€‚

---

## å››ã€ATRåŠ¨æ€å®‰å…¨è¾¹é™…ï¼ˆæ–°ï¼‰

### 4.1 é—®é¢˜èƒŒæ™¯

æ—§ç®—æ³•ä½¿ç”¨ç¡¬ç¼–ç çš„10%å®‰å…¨è¾¹é™…ï¼š
```python
# æ—§ç‰ˆï¼šæ‰€æœ‰è‚¡ç¥¨ç”¨åŒæ ·æ ‡å‡†ï¼ˆä¸åˆç†ï¼ï¼‰
if safety_margin >= 10:
    score = 100
```

**é—®é¢˜**ï¼šé«˜æ³¢åŠ¨è‚¡ï¼ˆå¦‚ NVDAï¼‰10%å¯èƒ½ä¸å¤Ÿå®‰å…¨ï¼Œä½æ³¢åŠ¨è‚¡ï¼ˆå¦‚ JNJï¼‰5%å°±å·²è¶³å¤Ÿã€‚

### 4.2 ATRè‡ªé€‚åº”æ–¹æ¡ˆ

```python
def calculate_atr_based_safety(current_price, strike, atr_14, atr_ratio=2.0):
    """
    å®‰å…¨è¾¹é™… = æ‰§è¡Œä»·è·ç¦» / (ATR Ã— ç³»æ•°)

    - é«˜æ³¢åŠ¨è‚¡ï¼ˆATRå¤§ï¼‰ï¼šéœ€è¦æ›´å¤§çš„ä»·å·®æ‰ç®—å®‰å…¨
    - ä½æ³¢åŠ¨è‚¡ï¼ˆATRå°ï¼‰ï¼šå°ä»·å·®ä¹Ÿç®—å®‰å…¨
    """
    required_buffer = atr_14 * atr_ratio  # éœ€è¦2å€ATRçš„å®‰å…¨ç¼“å†²
    actual_buffer = abs(current_price - strike)

    safety_ratio = actual_buffer / required_buffer
    # safety_ratio >= 1.0 è¡¨ç¤ºå®‰å…¨

    return {
        'safety_ratio': safety_ratio,      # å®‰å…¨è¾¹é™…æ¯”
        'atr_multiples': actual_buffer / atr_14,  # å‡ å€ATR
        'is_safe': safety_ratio >= 1.0
    }
```

### 4.3 ATRè®¡ç®—å…¬å¼

```python
# True Range = max(High-Low, |High-PrevClose|, |Low-PrevClose|)
# ATR(14) = 14æ—¥True Rangeçš„ç®€å•ç§»åŠ¨å¹³å‡
```

---

## äº”ã€å¤šå‘¨æœŸæ”¯æ’‘é˜»åŠ›åˆ†æï¼ˆæ–°ï¼‰

### 5.1 æ—§ç‰ˆé—®é¢˜

æ—§ç‰ˆåªä½¿ç”¨ç®€å•çš„æ–æ³¢é‚£å¥‘ï¼š
```python
# æ—§ç‰ˆï¼šè¿‡äºç®€å•
resistance_1 = close + diff * 0.236
support_1 = close - diff * 0.236
```

### 5.2 å¤šæ–¹æ³•ç»¼åˆè®¡ç®—

æ–°ç‰ˆä½¿ç”¨4ç§æ–¹æ³•äº¤å‰éªŒè¯ï¼š

| æ–¹æ³• | è¯´æ˜ | ç”¨é€” |
|------|------|------|
| **Pivot Points** | ç»å…¸æŠ€æœ¯åˆ†æ | æ—¥å†…æ”¯æ’‘é˜»åŠ› |
| **ç§»åŠ¨å¹³å‡çº¿** | MA20, MA50, MA200 | è¶‹åŠ¿æ”¯æ’‘é˜»åŠ› |
| **æ‘†åŠ¨é«˜ä½ç‚¹** | å±€éƒ¨æå€¼ç‚¹ | å†å²å…³é”®ä»·ä½ |
| **æ–æ³¢é‚£å¥‘** | 23.6%, 38.2%, 61.8%ç­‰ | å›è°ƒ/å»¶ä¼¸ä½ |

### 5.3 æ”¯æ’‘ä½å¼ºåº¦è¯„åˆ†

```python
def score_support_strength(strike, support_levels, current_price):
    """
    å¤šæ–¹æ³•ç¡®è®¤çš„ä½ç½®å¾—åˆ†æ›´é«˜
    """
    strength_score = 0

    for level in support_levels:
        if abs(strike - level['price']) / current_price < 0.02:  # 2%ä»¥å†…
            strength_score += level['method_count'] * 15   # å¤šæ–¹æ³•ç¡®è®¤åŠ åˆ†
            strength_score += level['test_count'] * 10     # æµ‹è¯•æ¬¡æ•°åŠ åˆ†

    return min(100, strength_score)
```

---

## å…­ã€Sell Put è®¡åˆ†å™¨

### 6.1 æƒé‡é…ç½®ï¼ˆä¼˜åŒ–ç‰ˆï¼‰

| æŒ‡æ ‡ | æ—§æƒé‡ | **æ–°æƒé‡** | è¯´æ˜ |
|------|--------|------------|------|
| premium_yield | 25% | **20%** | é™ä½ï¼Œé¿å…è¿½æ±‚é«˜æ”¶ç›Š |
| safety_margin | 20% | **15%** | æ”¹ç”¨ATRè‡ªé€‚åº” |
| **support_strength** | - | **20%** | **æ–°å¢**ï¼šæ”¯æ’‘ä½å¼ºåº¦ |
| **trend_alignment** | - | **15%** | **æ–°å¢**ï¼šè¶‹åŠ¿åŒ¹é…åº¦ |
| probability_profit | 20% | **15%** | ç›ˆåˆ©æ¦‚ç‡ |
| liquidity | 15% | **10%** | æµåŠ¨æ€§ |
| time_decay | 10% | **5%** | æ—¶é—´è¡°å‡ |
| volatility_premium | 10% | **0%** | å¹¶å…¥è¶‹åŠ¿åˆ†æ |

### 3.2 ç­›é€‰æ¡ä»¶

```python
# åªè€ƒè™‘è™šå€¼æˆ–è½»å¾®å®å€¼æœŸæƒ
strike <= current_price * 1.02

# å¿…é¡»æœ‰æ—¶é—´ä»·å€¼
time_value > 0
```

### 3.3 æ ¸å¿ƒè®¡ç®—å…¬å¼

```python
# æ—¶é—´ä»·å€¼è®¡ç®—
intrinsic_value = max(0, strike - current_price)
time_value = mid_price - intrinsic_value

# æ”¶ç›Šç‡è®¡ç®—
premium_yield = (time_value / strike) * 100          # å•æ¬¡æ”¶ç›Šç‡%
annualized_return = (premium_yield / days_to_expiry) * 365

# å®‰å…¨è¾¹é™…
safety_margin = ((current_price - strike) / current_price) * 100
```

### 3.4 åˆ†é¡¹è®¡åˆ†è§„åˆ™

#### premium_yield å¾—åˆ† (25åˆ†)

| å¹´åŒ–æ”¶ç›Šç‡ | å¾—åˆ† |
|-----------|------|
| â‰¥ 20% | 100 |
| 15% - 20% | 80 - 100 |
| 5% - 15% | 40 - 80 |
| < 5% | 0 - 40 |

#### safety_margin å¾—åˆ† (20åˆ†)

| å®‰å…¨è¾¹é™… | å¾—åˆ† |
|----------|------|
| â‰¥ 10% | 100 |
| 5% - 10% | 80 - 100 |
| 0% - 5% | 40 - 80 |
| < 0% | æ‰£åˆ† |

#### probability_profit å¾—åˆ† (20åˆ†)

ä½¿ç”¨ Black-Scholes æ¨¡å‹ä¼°ç®—ï¼š
```python
# N(-d2) = è‚¡ç¥¨ä»·æ ¼é«˜äºè¡Œæƒä»·çš„æ¦‚ç‡
d2 = (ln(S/K) + (r - ÏƒÂ²/2)T) / (ÏƒâˆšT)
prob_profit = N(-d2)
```

#### liquidity å¾—åˆ† (15åˆ†)

```python
liquidity_score = volume/10 + open_interest/50 + spread_score
spread_score = 100 * (1 - (ask-bid)/mid_price)
```

#### time_decay å¾—åˆ† (10åˆ†)

| åˆ°æœŸå¤©æ•° | å¾—åˆ† |
|----------|------|
| 20-45å¤© | 100 |
| 15-20å¤© æˆ– 45-60å¤© | 80-100 |
| å…¶ä»– | é€’å‡ |

### 3.5 è¾“å‡ºç»“æ„

```python
{
    'strike': float,               # è¡Œæƒä»·
    'premium_yield': float,        # å•æ¬¡æ”¶ç›Šç‡%
    'annualized_return': float,    # å¹´åŒ–æ”¶ç›Šç‡
    'safety_margin': float,        # å®‰å…¨è¾¹é™…%
    'score': float,                # 0-100ç»¼åˆè¯„åˆ†
    'assignment_risk': str,        # very_low/low/moderate/high/very_high
    'max_profit': float,           # æœ€å¤§æ”¶ç›Š
    'breakeven': float             # ç›ˆäºå¹³è¡¡ç‚¹
}
```

---

## å››ã€Sell Call è®¡åˆ†å™¨

### 4.1 æƒé‡é…ç½®

| æŒ‡æ ‡ | æƒé‡ | è¯´æ˜ |
|------|------|------|
| premium_yield | 25% | æœŸæƒè´¹æ”¶ç›Šç‡ |
| overvaluation | 20% | è‚¡ç¥¨è¶…ä¹°ç¨‹åº¦ |
| resistance_level | 20% | é˜»åŠ›ä½åˆ†æ |
| liquidity | 15% | æµåŠ¨æ€§ |
| time_decay | 10% | æ—¶é—´è¡°å‡ |
| volatility_timing | 10% | æ³¢åŠ¨ç‡æ‹©æ—¶ |

### 4.2 ç­›é€‰æ¡ä»¶

```python
# åªè€ƒè™‘è™šå€¼ Call
strike >= current_price * 0.98
```

### 4.3 ç‰¹æœ‰è®¡ç®—

```python
# ä¸Šæ¶¨ç¼“å†²ç©ºé—´
upside_buffer = ((strike - current_price) / current_price) * 100

# æ”¶ç›Šç‡åŸºäºè‚¡ä»·ï¼ˆéè¡Œæƒä»·ï¼‰
premium_yield = (time_value / current_price) * 100
```

### 4.4 æŠ€æœ¯åˆ†ææŒ‡æ ‡

```python
support_resistance = {
    'resistance_1': float,   # ç¬¬ä¸€é˜»åŠ›ä½
    'resistance_2': float,   # ç¬¬äºŒé˜»åŠ›ä½
    'support_1': float,      # ç¬¬ä¸€æ”¯æ’‘ä½
    'high_52w': float,       # 52å‘¨é«˜ç‚¹
    'low_52w': float         # 52å‘¨ä½ç‚¹
}
```

### 4.5 overvaluation è¯„åˆ†é€»è¾‘

| æ¡ä»¶ | å¾—åˆ†è°ƒæ•´ |
|------|----------|
| æ¥è¿‘ R1ï¼ˆâ‰¤2%ï¼‰| 90åˆ† |
| å½“æ—¥æ¶¨å¹… â‰¥3% | +20åˆ† |
| æ¥è¿‘52å‘¨é«˜ç‚¹ | +15-85åˆ† |

---

## äº”ã€Buy Call è®¡åˆ†å™¨

### 5.1 æƒé‡é…ç½®

| æŒ‡æ ‡ | æƒé‡ | è¯´æ˜ |
|------|------|------|
| bullish_momentum | 25% | ä¸Šæ¶¨åŠ¨é‡ |
| breakout_potential | 20% | çªç ´æ½œåŠ› |
| value_efficiency | 20% | ä»·å€¼æ•ˆç‡ (Delta/Price) |
| volatility_timing | 15% | æ³¢åŠ¨ç‡æ‹©æ—¶ |
| liquidity | 10% | æµåŠ¨æ€§ |
| time_optimization | 10% | æ—¶é—´ä»·å€¼ä¼˜åŒ– |

### 5.2 æ ¸å¿ƒè®¡ç®—

```python
# ä»·å€¼çŠ¶æ€
moneyness_pct = (current_price - strike) / current_price * 100

# ç›ˆäºå¹³è¡¡éœ€è¦çš„æ¶¨å¹…
required_move_pct = ((strike + mid_price - current_price) / current_price) * 100

# ç›ˆäºå¹³è¡¡ç‚¹
breakeven = strike + mid_price

# æ æ†å€æ•°
leverage_ratio = (delta * current_price) / mid_price

# æœ€å¤§äºæŸ
max_loss = mid_price * 100  # äºå®Œæƒåˆ©é‡‘
```

### 5.3 bullish_momentum è¯„åˆ†

| æ¡ä»¶ | å¾—åˆ† |
|------|------|
| å½“æ—¥æ¶¨å¹… â‰¥3% | 100 |
| å½“æ—¥æ¶¨å¹… â‰¥2% | 90 |
| æ¥è¿‘52å‘¨é«˜(â‰¥70%) | +20 |
| æ¥è¿‘é˜»åŠ›ä½(â‰¤5%) | +10 |

### 5.4 value_efficiency è¯„åˆ†

```python
efficiency = delta / mid_price

# è¯„åˆ†è§„åˆ™
if efficiency >= 0.6:
    score = 100
if -5% <= moneyness <= 5%:  # å¹³å€¼
    score += 10
if moneyness < -15%:        # æ·±åº¦è™šå€¼
    score -= 15
```

---

## å…­ã€Buy Put è®¡åˆ†å™¨

### 6.1 æƒé‡é…ç½®

| æŒ‡æ ‡ | æƒé‡ | è¯´æ˜ |
|------|------|------|
| bearish_momentum | 25% | ä¸‹è·ŒåŠ¨é‡ |
| support_break | 20% | æ”¯æ’‘ä½çªç ´ |
| value_efficiency | 20% | ä»·å€¼æ•ˆç‡ |
| volatility_expansion | 15% | æ³¢åŠ¨ç‡æ‰©å¼  |
| liquidity | 10% | æµåŠ¨æ€§ |
| time_value | 10% | æ—¶é—´ä»·å€¼ |

### 6.2 ç‰¹æœ‰è®¡ç®—

```python
# ä¸‹è·Œç©ºé—´
downside_potential = (current_price - strike) / current_price * 100

# å¯¹å†²æ•ˆç‡
hedge_efficiency = abs(delta) / premium
```

---

## ä¸ƒã€é£é™©æ”¶ç›Šé£æ ¼æ ‡ç­¾ç³»ç»Ÿ

### 7.1 å››ç§é£æ ¼åˆ†ç±»

| é£æ ¼ | ä¸­æ–‡ | èƒœç‡ | æ”¶ç›Šç‰¹å¾ | é¢œè‰² |
|------|------|------|----------|------|
| **steady_income** | ç¨³å¥æ”¶ç›Š | 65-80% | 1-5%/æœˆ | green |
| **balanced** | ç¨³ä¸­æ±‚è¿› | 40-55% | 50-200% | yellow |
| **high_risk_high_reward** | é«˜é£é™©é«˜æ”¶ç›Š | 20-40% | 2-10å€ | orange |
| **hedge** | ä¿æŠ¤å¯¹å†² | 30-50% | 0-1å€ | blue |

### 7.2 é£é™©ç­‰çº§

| ç­‰çº§ | è‹±æ–‡ | é¢œè‰² |
|------|------|------|
| ä½ | low | green |
| ä¸­ | moderate | yellow |
| é«˜ | high | orange |
| æé«˜ | very_high | red |

### 7.3 Sell Put é£æ ¼åˆ¤å®šé€»è¾‘

```python
if safety_margin_pct >= 10 and annualized_return <= 25:
    style = 'steady_income'         # æ·±åº¦è™šå€¼ + ä½æ”¶ç›Š
    risk_level = 'low'

elif safety_margin_pct >= 5 and annualized_return <= 40:
    style = 'balanced'              # ä¸­ç­‰è™šå€¼
    risk_level = 'moderate'

elif safety_margin_pct < 3 or annualized_return > 50:
    style = 'high_risk_high_reward' # æ¥è¿‘ATMæˆ–é«˜æ”¶ç›Š
    risk_level = 'high' or 'very_high'
```

### 7.4 å…³é”®æŒ‡æ ‡è®¡ç®—

```python
# Sell Put
max_profit_pct = (premium / strike) * 100
max_loss_pct = ((strike - premium) / strike) * 100
risk_reward_ratio = max_profit_pct / max_loss_pct
win_probability = norm.cdf(d2)  # Black-Scholes

# Buy Call
max_loss_pct = 100  # æœ€å¤šäºæŸæƒåˆ©é‡‘
expected_move = current_price * IV * sqrt(DTE/365)
max_profit_pct = (expected_move - strike - premium) / premium * 100
```

---

## å…«ã€RV è¯„åˆ†ç³»ç»Ÿ

RV = Recommendation Valueï¼ˆæ¨èå€¼ï¼‰

### 8.1 å››ç§ RV è¯„åˆ†

| è¯„åˆ† | å…¨ç§° | ç”¨é€” |
|------|------|------|
| SPRV | Sell Put Recommendation Value | ç­›é€‰ Sell Put |
| SCRV | Sell Call Recommendation Value | ç­›é€‰ Sell Call |
| BCRV | Buy Call Recommendation Value | ç­›é€‰ Buy Call |
| BPRV | Buy Put Recommendation Value | ç­›é€‰ Buy Put |

### 8.2 SPRV è®¡åˆ†è¯¦è§£ (æ»¡åˆ†100)

| æŒ‡æ ‡ | åˆ†å€¼ | è®¡ç®—è§„åˆ™ |
|------|------|----------|
| æ”¶ç›Šç‡å¾—åˆ† | 30 | å¹´åŒ–æ”¶ç›Š 0-50% â†’ 0-30åˆ† |
| èƒœç‡å¾—åˆ† | 25 | win_rate = 1 - \|delta\| |
| IVç­‰çº§å¾—åˆ† | 15 | IV Rank 30-100 â†’ 0-15åˆ† |
| æµåŠ¨æ€§å¾—åˆ† | 15 | ç»¼åˆä»·å·®å’ŒæŒä»“é‡ |
| Thetaå¾—åˆ† | 10 | theta 0.01-0.10 â†’ 0-10åˆ† |
| Gammaæƒ©ç½š | -5 | gamma > 0.02 å¼€å§‹æ‰£åˆ† |

### 8.3 æ·±åº¦è™šå€¼æƒ©ç½š

```python
moneyness_ratio = strike / stock_price

if moneyness_ratio < 0.7:
    depth_penalty = moneyness_ratio / 0.7
elif moneyness_ratio < 0.85:
    depth_penalty = 0.6 + (moneyness_ratio - 0.7) / 0.15 * 0.3

final_score = raw_score * depth_penalty
```

### 8.4 BCRV ç‰¹æ®Šè°ƒæ•´

| æŒ‡æ ‡ | åˆ†å€¼ | è¯´æ˜ |
|------|------|------|
| Deltaæ–¹å‘æ€§ | 30 | Delta * 30 |
| Gamma/Thetaæ•ˆç‡ | 25 | æ•ˆç‡æ¯” |
| ä½IVå¾—åˆ† | 15 | IV Rank 0-50 æœ€ä¼˜ |
| æµåŠ¨æ€§ | 15 | - |
| Thetaæƒ©ç½š | -10 | æ—¶é—´è¡°å‡æˆæœ¬ |
| Gammaæ æ†åŠ åˆ† | +5 | æ æ†æ•ˆåº” |

---

## ä¹ã€æµåŠ¨æ€§è¯„åˆ†ç³»ç»Ÿ

### 9.1 è®¡ç®—å…¬å¼

```python
def calculate_liquidity_factor(bid, ask, open_interest):
    # ä¸€ç¥¨å¦å†³ï¼šOI < 10 ç›´æ¥è¿”å› 0
    if open_interest < 10:
        return 0.0

    # ç»¼åˆå¾—åˆ† = 40% ä»·å·®å¾—åˆ† + 60% æŒä»“é‡å¾—åˆ†
    composite = 0.4 * spread_score + 0.6 * oi_score
    return max(0.0, min(1.0, composite))
```

### 9.2 ä»·å·®å¾—åˆ† (Spread Score)

| Bid-Ask ä»·å·®æ¯” | å¾—åˆ† |
|----------------|------|
| â‰¤ 1% | 1.0 |
| 1% - 3% | 0.8+ |
| 3% - 5% | 0.5+ |
| 5% - 10% | 0.2+ |
| > 10% | 0.0 |

### 9.3 æŒä»“é‡å¾—åˆ† (OI Score)

| Open Interest | å¾—åˆ† |
|---------------|------|
| â‰¥ 500 | 1.0 |
| 200 - 500 | 0.8+ |
| 50 - 200 | 0.6+ |
| 10 - 50 | 0.3+ |
| < 10 | 0.0 (ä¸€ç¥¨å¦å†³) |

---

## åã€VRP è®¡ç®—ç³»ç»Ÿ

VRP = Volatility Risk Premiumï¼ˆæ³¢åŠ¨ç‡é£é™©æº¢ä»·ï¼‰

### 10.1 è®¡ç®—å†…å®¹

| æŒ‡æ ‡ | è¯´æ˜ |
|------|------|
| HV_30 | 30å¤©å†å²æ³¢åŠ¨ç‡ |
| HV_10 | 10å¤©å†å²æ³¢åŠ¨ç‡ |
| HV_5 | 5å¤©å†å²æ³¢åŠ¨ç‡ |
| IV Rank | éšå«æ³¢åŠ¨ç‡æ’å (0-100) |
| IV Percentile | éšå«æ³¢åŠ¨ç‡ç™¾åˆ†ä½ |
| VRP | IV - RV å·®å€¼ |

### 10.2 VRP ç­‰çº§é˜ˆå€¼

| VRP å€¼ | ç­‰çº§ | å¯¹å–æ–¹ |
|--------|------|--------|
| > 15% | very_high | éå¸¸æœ‰åˆ© |
| 5% - 15% | high | æœ‰åˆ© |
| -5% - 5% | normal | ä¸­æ€§ |
| -15% - -5% | low | ä¸åˆ© |
| < -15% | very_low | éå¸¸ä¸åˆ© |

### 10.3 èƒœç‡è°ƒæ•´

```python
if vrp_level == 'very_high':
    # å–æ–¹ç­–ç•¥æœ‰åˆ©ï¼Œæé«˜èƒœç‡ä¼°è®¡
    base_win_prob = min(0.90, base_win_prob + 0.05)

elif vrp_level == 'very_low':
    # ä¹°æ–¹ç­–ç•¥æœ‰åˆ©
    base_win_prob = min(0.60, base_win_prob + 0.05)
```

---

## åä¸€ã€æ¨èæ’åºé€»è¾‘

### 11.1 æ•´ä½“æµç¨‹

```
1. è·å–æœŸæƒé“¾æ•°æ® + è‚¡ç¥¨æ•°æ® + VRPåˆ†æ
   â†“
2. é’ˆå¯¹æ¯ä¸ªæœŸæƒè®¡åˆ†ï¼ˆæ ¹æ®ç­–ç•¥ï¼‰
   â”œâ”€ Sell Put  â†’ SPRV è®¡åˆ†å™¨
   â”œâ”€ Sell Call â†’ SCRV è®¡åˆ†å™¨
   â”œâ”€ Buy Call  â†’ BCRV è®¡åˆ†å™¨
   â””â”€ Buy Put   â†’ BPRV è®¡åˆ†å™¨
   â†“
3. åº”ç”¨ç­›é€‰æ¡ä»¶
   â”œâ”€ æµåŠ¨æ€§ OI >= 10
   â”œâ”€ ä»·å·® <= 10%
   â””â”€ æ—¶é—´ä»·å€¼ > 0
   â†“
4. åŠ å…¥é£é™©æ”¶ç›Šé£æ ¼æ ‡ç­¾
   â”œâ”€ é£æ ¼åˆ†ç±»ï¼ˆ4ç§ï¼‰
   â”œâ”€ é£é™©ç­‰çº§ï¼ˆ4çº§ï¼‰
   â””â”€ å…³é”®æŒ‡æ ‡ï¼ˆèƒœç‡ã€æ”¶ç›Šã€é£é™©ï¼‰
   â†“
5. æŒ‰ç»¼åˆå¾—åˆ†å€’åºæ’åˆ—
   â†“
6. è¿”å› Top 10 æ¨è
```

### 11.2 è¿”å›æ•°æ®ç»“æ„

```json
{
  "success": true,
  "symbol": "AAPL",
  "recommendations": [
    {
      "strike": 170,
      "mid_price": 2.65,
      "premium_yield": 1.56,
      "annualized_return": 18.96,
      "safety_margin": 5.75,
      "score": 78.5,
      "score_breakdown": {
        "premium_yield": 80.0,
        "safety_margin": 75.0,
        "probability_profit": 70.0,
        "liquidity": 85.0,
        "time_decay": 90.0,
        "volatility_premium": 65.0
      },
      "risk_return_profile": {
        "style": "balanced",
        "style_label": "ç¨³ä¸­æ±‚è¿› / BALANCED",
        "risk_level": "moderate",
        "risk_color": "yellow",
        "win_probability": 0.72,
        "max_profit_pct": 1.56,
        "max_loss_pct": 98.44,
        "summary_cn": "èƒœç‡çº¦72%ï¼Œæ”¶ç›Š1.56%ï¼Œ15å¤©åˆ°æœŸï¼Œé£é™©æ”¶ç›Šå‡è¡¡"
      }
    }
  ],
  "strategy_analysis": {
    "market_outlook": "neutral_to_bullish",
    "strategy_suitability": "good",
    "risk_level": "moderate"
  }
}
```

---

## åäºŒã€å…³é”®ç®—æ³•æ€»ç»“

| ç®—æ³• | è¾“å…¥ | è¾“å‡º | åº”ç”¨åœºæ™¯ |
|------|------|------|----------|
| SPRV | Greeks, æµåŠ¨æ€§ | 0-100è¯„åˆ† | ç­›é€‰ Sell Put |
| SCRV | Greeks, æŠ€æœ¯æŒ‡æ ‡ | 0-100è¯„åˆ† | ç­›é€‰ Sell Call |
| BCRV | Delta/Gamma/Thetaæ¯” | 0-100è¯„åˆ† | ç­›é€‰ Buy Call |
| BPRV | Deltaæ•ˆç‡, å¯¹å†²æˆæœ¬ | 0-100è¯„åˆ† | ç­›é€‰ Buy Put |
| VRP | IV vs RV | ç­‰çº§+èƒœç‡è°ƒæ•´ | ä¼˜åŒ–æœŸæƒä¼°å€¼ |
| é£é™©æ”¶ç›Šé£æ ¼ | æ”¶ç›Šç‡, èƒœç‡, é£é™© | 4åˆ†ç±»+é¢œè‰² | ç”¨æˆ·å†³ç­–æ”¯æŒ |

---

## åä¸‰ã€è®¾è®¡äº®ç‚¹

1. **åˆ†ç¦»æ—¶é—´ä»·å€¼å’Œå†…åœ¨ä»·å€¼**ï¼šSell Put/Call åªè®¡ç®—æ—¶é—´ä»·å€¼çš„æ”¶ç›Šç‡ï¼Œæ›´å‡†ç¡®åæ˜ çœŸå®æ”¶ç›Š
2. **æ·±åº¦è™šå€¼æƒ©ç½š**ï¼šé˜²æ­¢è¿‡åº¦è™šå€¼çš„æœŸæƒè¢«è¿‡åº¦è¯„åˆ†
3. **Black-Scholes èƒœç‡ä¼°ç®—**ï¼šä½¿ç”¨ N(d2) è®¡ç®—åˆ°æœŸæ—¶ä»·æ ¼æ–¹å‘æ¦‚ç‡
4. **é£é™©ç­‰çº§ä¸é¢œè‰²ç¼–ç **ï¼šé™ä½ç”¨æˆ·ç†è§£æˆæœ¬
5. **åŒå‘å¼‚æ­¥æ”¯æŒ**ï¼šé€‚åº”å¤§æ•°æ®é‡å®æ—¶å¤„ç†
6. **VRP åŠ¨æ€è°ƒæ•´**ï¼šæ ¹æ®å¸‚åœºçŠ¶å†µè‡ªåŠ¨è°ƒæ•´èƒœç‡é¢„æœŸ
7. **å¤šç»´åº¦ç»¼åˆè¯„åˆ†**ï¼šç»“åˆæ”¶ç›Šã€é£é™©ã€æµåŠ¨æ€§ã€æŠ€æœ¯åˆ†æç­‰å¤šä¸ªç»´åº¦
