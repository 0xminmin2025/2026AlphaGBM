# AlphaG - 基于 Gemini AI 的智能股票分析系统

一个集成了 Google Gemini AI 的股票投资分析系统，采用 **G=B+M 模型**（胡猛投机模型）和**五大支柱投资框架**，为投资者提供专业的股票分析和投资建议。

## 📋 目录

- [功能特性](#功能特性)
- [技术架构](#技术架构)
- [安装指南](#安装指南)
- [配置说明](#配置说明)
- [使用方法](#使用方法)
- [投资模型说明](#投资模型说明)
- [API 接口](#api-接口)
- [项目结构](#项目结构)
- [注意事项](#注意事项)
- [常见问题](#常见问题)

## ✨ 功能特性

### 核心功能

1. **多市场支持**
   - 美股（如：AAPL, TSLA）
   - 港股（如：2525, 2525.HK）
   - A股（如：600519, 000001）

2. **智能股票代码识别**
   - 自动识别市场类型并添加相应后缀
   - 支持多种输入格式

3. **G=B+M 模型分析**
   - **G (价格)**: 当前价格、52周区间、技术指标
   - **B (基本面)**: 营收增长、利润率、PE/PEG 估值
   - **M (市场情绪)**: 市场情绪评分、VIX恐慌指数、期权市场数据、宏观经济指标

4. **风险评分系统**
   - 0-10 分风险评分
   - 风险等级分类（低/中/高/极高）
   - 风险点标识

5. **仓位建议**
   - 根据投资风格和风险评分计算建议仓位
   - 支持四种投资风格：
     - **质量 (Quality)**: 最大仓位 20%
     - **价值 (Value)**: 最大仓位 10%
     - **成长 (Growth)**: 最大仓位 15%
     - **趋势 (Momentum)**: 最大仓位 5%

6. **AI 投资分析报告**
   - 使用 Google Gemini AI 生成专业的投资分析报告
   - 包含投资风格分析、G=B+M 深度解构、五大支柱检查、具体交易策略

7. **目标价格计算**
   - 多维度估值模型（PE/PEG估值、增长率折现、技术面分析）
   - 根据公司类别和投资风格调整权重

8. **市场预警系统**
   - VIX 恐慌指数预警
   - Put/Call 比率预警
   - 美债收益率预警
   - 美联储利率决议提醒
   - CPI 数据发布提醒
   - 期权到期日（交割日）预警
   - 财报日期提醒
   - 成交量异常检测
   - 地缘政治风险指数

9. **宏观经济数据**
   - 10年期美债收益率
   - 美元指数 (DXY)
   - 黄金价格
   - 原油价格
   - Polymarket 预测市场数据

10. **期权市场分析**
    - VIX 恐慌指数
    - Put/Call 比率
    - Vanna crush 和负 Gamma 风险检测

## 🏗️ 技术架构

### 后端技术栈

- **Flask**: Web 框架
- **Flask-CORS**: 跨域支持
- **yfinance**: 股票数据获取
- **pandas & numpy**: 数据处理
- **google-generativeai**: Gemini AI 集成
- **python-dotenv**: 环境变量管理
- **requests**: HTTP 请求

### 前端技术栈

- HTML5 + CSS3
- JavaScript (原生)
- Chart.js (图表展示)

### 系统架构

```
┌─────────────┐
│  前端界面    │
│ (index.html) │
└──────┬───────┘
       │ HTTP/JSON
       ▼
┌─────────────┐
│  Flask API  │
│   (app.py)   │
└──────┬───────┘
       │
       ├──► analysis_engine.py (数据分析引擎)
       │    ├── 数据获取
       │    ├── 风险评分
       │    ├── 市场情绪计算
       │    └── 目标价格计算
       │
       └──► ai_service.py (AI 服务)
            └── Gemini AI 分析报告生成
```

## 📦 安装指南

### 环境要求

- Python 3.8+
- pip

### 安装步骤

1. **克隆仓库**

```bash
git clone git@github.com:0xminmin2025/AlphaG.git
cd AlphaG
```

2. **创建虚拟环境**

```bash
python3 -m venv venv
source venv/bin/activate  # macOS/Linux
# 或
venv\Scripts\activate  # Windows
```

3. **安装依赖**

```bash
pip install -r requirements.txt
```

4. **配置环境变量**

创建 `.env` 文件（在项目根目录）：

```env
GOOGLE_API_KEY=your_gemini_api_key_here
```

获取 Gemini API Key：
1. 访问 [Google AI Studio](https://makersuite.google.com/app/apikey)
2. 创建新的 API Key
3. 将 API Key 复制到 `.env` 文件中

## ⚙️ 配置说明

### 环境变量

| 变量名 | 说明 | 必需 |
|--------|------|------|
| `GOOGLE_API_KEY` | Google Gemini API 密钥 | 是 |

### 端口配置

默认端口：**5001**

> 注意：macOS 系统上端口 5000 被 Apple AirPlay 占用，因此使用 5001 端口。

如需修改端口，编辑 `app.py`：

```python
app.run(debug=True, port=5001, host='0.0.0.0', threaded=True)
```

## 🚀 使用方法

### 启动服务器

```bash
python app.py
```

服务器启动后，访问：`http://127.0.0.1:5001`

### 使用界面

1. 在输入框中输入股票代码（如：AAPL, 2525, 600519）
2. 选择投资风格（质量/价值/成长/趋势）
3. 点击"分析"按钮
4. 等待分析完成（通常需要 5-15 秒）
5. 查看分析结果：
   - 股票基本信息
   - 风险评分和仓位建议
   - AI 生成的投资分析报告
   - 目标价格和止损价格
   - 市场预警信息

### 命令行测试

使用 curl 测试 API：

```bash
curl -X POST http://127.0.0.1:5001/api/analyze \
  -H "Content-Type: application/json" \
  -d '{"ticker": "AAPL", "style": "quality"}'
```

## 📊 投资模型说明

### G=B+M 模型

**胡猛投机模型**，将股票价格分解为三个维度：

- **G (价格)**: 当前价格相对于内在价值的差异
- **B (基本面)**: 公司的财务健康状况和盈利能力
- **M (市场情绪)**: 市场对股票的估值和情绪

### 五大支柱投资框架

1. **怀疑主义 (Skepticism)**: 充当"空头律师"，列出不买这只股票的理由
2. **事前验尸 (Pre-mortem)**: 假设买入后亏损 50%，分析最可能的原因
3. **风险控制**: 严格的仓位管理和止损纪律
4. **投资风格一致性**: 确保所有建议符合所选投资风格
5. **数据驱动**: 基于硬数据和逻辑，而非情绪

### 风险评分系统

风险评分范围：0-10 分

| 分数 | 风险等级 | 建议仓位调整 |
|------|---------|------------|
| 0-2 | 低 | 100% 基础仓位 |
| 2-4 | 中 | 70% 基础仓位 |
| 4-6 | 高 | 40% 基础仓位 |
| 6-10 | 极高 | 0% (不建议建仓) |

### 投资风格说明

#### 质量 (Quality)
- **核心原则**: 关注财务稳健、盈利能力强、债务水平低、护城河深的优质公司
- **最大仓位**: 20%
- **持有周期**: 长期 (1-3年)
- **适合**: 追求稳定收益的投资者

#### 价值 (Value)
- **核心原则**: 寻找被市场低估的股票，关注低PE、低PEG，追求安全边际
- **最大仓位**: 10%
- **持有周期**: 中期 (6-12个月)
- **适合**: 追求安全边际的价值投资者

#### 成长 (Growth)
- **核心原则**: 追求高营收增长和盈利增长的公司，容忍较高估值但要求持续增长
- **最大仓位**: 15%
- **持有周期**: 中短期 (3-6个月)
- **适合**: 追求高增长的成长投资者

#### 趋势 (Momentum)
- **核心原则**: 跟随市场趋势和价格动量，快进快出，关注技术面突破
- **最大仓位**: 5%
- **持有周期**: 短期 (1-3个月)
- **适合**: 追求短期收益的趋势投资者

## 🔌 API 接口

### POST /api/analyze

分析股票并返回投资建议。

**请求体**:

```json
{
  "ticker": "AAPL",
  "style": "quality"
}
```

**参数说明**:

| 参数 | 类型 | 必需 | 说明 |
|------|------|------|------|
| ticker | string | 是 | 股票代码（支持美股、港股、A股） |
| style | string | 是 | 投资风格：quality/value/growth/momentum |

**响应示例**:

```json
{
  "success": true,
  "data": {
    "symbol": "AAPL",
    "name": "Apple Inc.",
    "price": 175.50,
    "pe": 28.5,
    "growth": 0.15,
    "margin": 0.25,
    "market_sentiment": 6.5,
    "target_price": 185.00
  },
  "risk": {
    "score": 3,
    "level": "中",
    "flags": [],
    "suggested_position": 14.0
  },
  "report": "## 投资分析报告...\n\n[AI 生成的详细分析]"
}
```

## 📁 项目结构

```
AlphaG/
├── app.py                 # Flask 应用主文件
├── analysis_engine.py     # 数据分析引擎
├── ai_service.py          # AI 服务（Gemini 集成）
├── requirements.txt      # Python 依赖
├── .env                  # 环境变量（需自行创建）
├── .gitignore           # Git 忽略文件
├── README.md            # 项目说明文档
├── templates/
│   └── index.html       # 前端界面
├── venv/                # 虚拟环境（不提交到 Git）
├── __pycache__/         # Python 缓存（不提交到 Git）
├── server.log           # 服务器日志（不提交到 Git）
└── server.pid           # 服务器进程 ID（不提交到 Git）
```

## ⚠️ 注意事项

### 数据来源

- 股票数据来自 **Yahoo Finance** (yfinance)
- 数据可能存在延迟（通常 15-20 分钟）
- 部分股票可能无法获取完整数据

### API 限制

- **Gemini API**: 有免费额度限制，超出后需要付费
- 如果 Gemini API 不可用，系统会自动使用备用分析功能

### 投资建议

- **本系统仅供学习和研究使用，不构成投资建议**
- 所有投资决策应基于您自己的研究和判断
- 投资有风险，入市需谨慎
- 建议结合其他数据源和专家意见

### 数据准确性

- 系统尽力确保数据准确性，但不保证 100% 准确
- 建议定期验证关键数据
- 对于重要投资决策，请使用多个数据源验证

## ❓ 常见问题

### Q1: 为什么某些股票代码无法识别？

**A**: 系统会自动识别市场类型，但某些特殊格式可能需要手动添加后缀：
- 港股：添加 `.HK`（如：2525.HK）
- A股上海：添加 `.SS`（如：600519.SS）
- A股深圳：添加 `.SZ`（如：000001.SZ）

### Q2: Gemini API 报错怎么办？

**A**: 
1. 检查 `.env` 文件中的 `GOOGLE_API_KEY` 是否正确
2. 确认 API Key 是否有效且有足够额度
3. 如果 API 不可用，系统会自动使用备用分析功能

### Q3: 分析结果不准确怎么办？

**A**: 
- 系统基于公开数据进行分析，可能存在数据延迟
- 建议结合其他数据源验证
- 可以尝试不同的投资风格，查看不同角度的分析

### Q4: 如何修改端口？

**A**: 编辑 `app.py` 文件，修改 `app.run()` 中的 `port` 参数。

### Q5: 支持哪些市场？

**A**: 目前支持：
- 美股（NYSE, NASDAQ）
- 港股（HKEX）
- A股（上交所、深交所）

### Q6: 如何获取更多市场数据？

**A**: 系统使用 yfinance 库，支持所有 Yahoo Finance 覆盖的市场。如需添加其他数据源，可以修改 `analysis_engine.py` 中的 `get_market_data()` 函数。

## 📝 更新日志

### v1.0.0 (2025-01)
- 初始版本发布
- 支持 G=B+M 模型分析
- 集成 Gemini AI 生成投资报告
- 支持四种投资风格
- 市场预警系统
- 多市场股票数据支持

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 📄 许可证

本项目仅供学习和研究使用。

## 👤 作者

- **minmin** - [GitHub](https://github.com/0xminmin2025)
- **Email**: nftventure@gmail.com

## 🙏 致谢

- [Yahoo Finance](https://finance.yahoo.com/) - 股票数据源
- [Google Gemini AI](https://ai.google.dev/) - AI 分析能力
- [Flask](https://flask.palletsprojects.com/) - Web 框架
- [yfinance](https://github.com/ranaroussi/yfinance) - 股票数据获取库

---

**免责声明**: 本系统仅供学习和研究使用，不构成任何投资建议。投资有风险，入市需谨慎。使用本系统进行投资决策的所有后果由用户自行承担。

